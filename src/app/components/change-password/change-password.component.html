<h2 mat-dialog-title>Change Password</h2>
<mat-dialog-content>
    <form [formGroup]="passwordForm">
        <mat-form-field appearance="outline" class="form-field">
            <mat-label>Old Password</mat-label>
            <input matInput [type]="hideOld ? 'password' : 'text'" formControlName="oldPassword">
            <mat-error *ngIf="passwordForm.get('oldPassword')?.errors?.['required']">
                Old password is required.
            </mat-error>
            <button mat-icon-button matSuffix (click)="hideOld = !hideOld" [attr.aria-label]="'Hide old password'" [attr.aria-pressed]="hideOld">
                <mat-icon>{{hideOld ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field password" [ngStyle]="{ 'margin-bottom' : ((passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasLowerCase'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasSpecialChar']) || (passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasLowerCase']) ||Â (passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase'])) ? '17px' : '' }">
          <mat-label>New Password</mat-label>
          <input matInput [type]="hideNew ? 'password' : 'text'" formControlName="newPassword">
          <mat-error *ngIf="passwordForm.get('newPassword')?.errors?.['required']">
            Password is required.
          </mat-error>
          <mat-error *ngIf="passwordForm.get('newPassword')?.touched && passwordForm.get('newPassword')?.errors?.['minlength']">
            Password must be at least 6 characters long.
          </mat-error>
          <mat-error *ngIf="passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase']">
            Password must contain at least one uppercase letter.
          </mat-error>
          <mat-error *ngIf="passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasLowerCase']">
            Password must contain at least one lowercase letter.
          </mat-error>
          <mat-error *ngIf="passwordForm.get('newPassword')?.touched && !passwordForm.get('newPassword')?.errors?.['minlength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasUpperCase'] && passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasLowerCase'] && !passwordForm.get('newPassword')?.errors?.['passwordStrength']['hasSpecialChar']">
            Password must contain at least one special character.
          </mat-error>
          <button mat-icon-button matSuffix (click)="hideNew = !hideNew" [attr.aria-label]="'Hide new password'" [attr.aria-pressed]="hideNew">
              <mat-icon>{{hideNew ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
            <mat-label>Confirm New Password</mat-label>
            <input matInput [type]="hideConfirm ? 'password' : 'text'" formControlName="confirmNewPassword">
            <mat-error *ngIf="passwordForm.get('confirmNewPassword')?.errors?.['required']">
                Confirmation of the new password is required.
            </mat-error>
            <mat-error *ngIf="passwordForm.hasError('confirmedValidator')">
                Passwords do not match.
            </mat-error>
            <button mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm" [attr.aria-label]="'Hide confirm password'" [attr.aria-pressed]="hideConfirm">
                <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
        </mat-form-field>
    </form>
</mat-dialog-content>
<mat-dialog-actions>
    <button mat-raised-button color="primary" (click)="updatePassword()">Save</button>&nbsp;
    <button mat-stroked-button mat-dialog-close>Cancel</button>
</mat-dialog-actions>
